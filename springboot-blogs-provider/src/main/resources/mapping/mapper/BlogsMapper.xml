<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jk.blogs.mapper.BlogsMapper" >

    <select id="HotBlogs" resultType="com.jk.blogs.model.Blogs">
        SELECT * from t_blogs b ORDER BY b.blogs_like DESC LIMIT 0,5
    </select>

    <select id="WeekHotBlogs" resultType="com.jk.blogs.model.Blogs">
        SELECT * FROM t_blogs b
        WHERE DATE_SUB(CURDATE(), INTERVAL 7 DAY) &lt;= date(blogs_time)
        ORDER BY b.blogs_look DESC
        LIMIT 0,5
    </select>

    <select id="slideShow" resultType="com.jk.blogs.model.SlideShow">
        SELECT * from t_slideShow
    </select>

    <select id="querysum" resultType="int">
  	select count(*) from  t_blogs a


  </select>

    <select id="queryzhangAll" resultType="java.util.Map">

			select
				a.*
			from  t_blogs a  where  blogs_status=1

			       LIMIT #{sta},#{end}
   </select>


    <update  id="updateblogs">
    update t_blogs
    set
       blogs_title = #{b.blogs_title},
       blogs_content = #{b.blogs_content},
       blogs_time = #{b.blogs_time},
       blogs_userid = #{b.blogs_userid},
       blogs_like = #{b.blogs_like},
    where blogs_id = #{b.blogs_id}
  </update>

    <select id="queryblogsById" resultType="com.jk.blogs.model.Blogs">
  	select * from t_blogs where blogs_id = #{pid}

  </select>

    <update  id="updateblogsautus">
    update t_blogs
    set blogs_status=2
    where blogs_id = #{pid}e
  </update>


    <select id="querysum1" resultType="int">
  	select count(*) from  t_blogs a


  </select>

    <select id="queryzhanghui" resultType="java.util.Map">

			select
				a.*
			from  t_blogs a  where  blogs_status=2

			       LIMIT #{sta},#{end}
   </select>

    <select id="queryBlogsNews" resultType="com.jk.blogs.model.Blogs">
        SELECT blogs_id,b.blogs_title,b.blogs_content,b.blogs_img,b.blogs_like,b.blogs_look,b.blogs_url,b.blogs_time,u.named AS blogs_username,blogs_userid FROM
        t_blogs b,t_user6 u where b.blogs_userid=u.userId  ORDER BY b.blogs_time desc LIMIT 0,5
    </select>

    <select id="NewComment" resultType="com.jk.comment.model.Comment">
        SELECT
        u.username userName,c.creatTime dateTime,c.commentContent commentContent,u.headImg headImg,b.blogs_url blogs_url
        from t_comment c
        LEFT JOIN t_user6 u ON c.userId = u.userId
        LEFT JOIN t_blogs b ON c.blogs_id = b.blogs_id
        ORDER BY c.creatTime DESC
        LIMIT 0,5
    </select>
    
    <select id="queryBlogsById" resultType="com.jk.blogs.model.Blogs">
        select blogs_id,blogs_title,blogs_content,blogs_time,blogs_userid,blogs_like,blogs_img,
        blogs_look,blogs_url,blogs_status,u.named blogs_username
        from t_blogs b
        LEFT JOIN t_user6 u ON b.blogs_userid = u.userId
        where blogs_id = #{id}
    </select>

    <select id="queryUserById" resultType="com.jk.user.model.User">
        select  * from t_user6 where userId = #{id}
    </select>

    <select id="queryFansState" resultType="com.jk.blogs.model.Fans">
        select * from t_fans where fans_id = ${fansid} and star_id = #{starid}
    </select>

    <delete id="deleteFans">
        delete from t_fans where fans_id = ${fansid} and star_id = #{starid}
    </delete>

    <select id="queryFansAndState" resultType="com.jk.blogs.model.Fans">
        select * from t_fans where fans_id = #{fansid} and star_id = #{starid}
    </select>

    <update id="updateFansState">
        update t_fans set and_id = #{andid}
        where fans_id = #{fansid} and star_id = #{starid}
    </update>

    <insert id="SetFansState">
        insert into t_fans(fans_id,star_id,and_id)
        values(#{fansid},#{starid},#{andid})
    </insert>

    <update id="updateHeAndId">
        update t_fans set and_id = #{sta}
        where fans_id = #{fansid} and star_id = #{starid}
    </update>

    <select id="queryBlogsLikeButtonState" resultType="int">
        SELECT count(*) FROM t_blogs_like b WHERE b.like_user_id = #{u} AND b.like_blogs_id = #{b}
    </select>

    <update id="updateBlogsTableLike">
        UPDATE t_blogs SET blogs_like = blogs_like ${s} where blogs_id = #{blogsid}
    </update>

    <insert id="addLikeTableLike">
        INSERT INTO t_blogs_like(like_blogs_id,like_user_id)
        VALUES(#{blogsid},#{userid})
    </insert>

    <delete id="deleteLikeTableLike">
        DELETE FROM t_blogs_like WHERE like_blogs_id = #{blogsid} and like_user_id = #{userid}
    </delete>

    <update id="addBlogsLookById">
        update t_blogs set blogs_look = blogs_look+1 where blogs_id = #{id}
    </update>
</mapper>